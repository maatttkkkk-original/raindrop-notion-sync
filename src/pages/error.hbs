<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Error - Raindrop/Notion Sync</title>
  
  <link rel="stylesheet" href="/styles/design-system.css">
  <link rel="stylesheet" href="/styles/components.css">
  <link rel="stylesheet" href="/styles/dashboard.css">
</head>
<body>
  <div class="container">
    <main class="dashboard-8-section" id="main-content" role="main">
      <!-- Section 1: Title -->
      <div class="dashboard-section section-1 bg-white">
        <div class="section-content">
          <h1 class="text-huge">Raindrop/Notion Sync</h1>
        </div>
      </div>
      
      <div class="dashboard-divider"></div>
      
      <!-- Section 2: Error Title -->
      <div class="dashboard-section section-2 bg-white">
        <div class="section-content">
          <div class="count-display error" id="errorTitle">
            <span class="text-huge text-red">Error</span>
          </div>
        </div>
      </div>
      
      <div class="dashboard-divider"></div>
      
      <!-- Section 3: Back Button -->
      <div class="dashboard-section section-3 bg-yellow">
        <div class="section-content">
          <a 
            href="/?password={{password}}" 
            class="action-button primary text-huge"
            id="back-button"
          >
            Back ↺
          </a>
        </div>
      </div>
      
      <div class="dashboard-divider"></div>
      
      <!-- Section 4: Error Message -->
      <div class="dashboard-section section-4 bg-white">
        <div class="section-content">
          <div class="status-message" id="statusMessage">
            <span class="text-large error-message" id="error-message">
              {{#if error}}
                {{error}}
              {{else}}
                An unexpected error occurred
              {{/if}}
            </span>
          </div>
        </div>
      </div>
      
      <div class="dashboard-divider"></div>
      
      <!-- Section 5: Error Code -->
      <div class="dashboard-section section-5 bg-white">
        <div class="section-content">
          {{#if code}}
          <div class="error-code">
            <div class="text-small error-code-label">Error Code</div>
            <div class="text-medium error-code-value">{{code}}</div>
          </div>
          {{/if}}
        </div>
      </div>
      
      <div class="dashboard-divider"></div>
      
      <!-- Section 6: Error Details -->
      <div class="dashboard-section section-6 bg-white">
        <div class="section-content">
          {{#if details}}
          <div class="error-details-extended">
            <div class="text-small error-details-label">Details</div>
            <div class="text-small error-details-text">{{details}}</div>
          </div>
          {{/if}}
        </div>
      </div>
      
      <div class="dashboard-divider"></div>
      
      <!-- Section 7: Action Buttons -->
      <div class="dashboard-section section-7 bg-white log-section" id="log-section">
        <div class="section-content">
          <div class="dashboard-actions error-actions" role="navigation" aria-label="Error recovery actions">
            <button 
              type="button"
              class="action-button secondary text-medium"
              id="retry-button"
            >
              Try Again ↻
            </button>
            
            {{#if supportUrl}}
            <a 
              href="{{supportUrl}}" 
              class="action-button secondary text-medium"
              target="_blank"
              rel="noopener noreferrer"
            >
              Get Help →
            </a>
            {{/if}}
          </div>
        </div>
      </div>
      
      <div class="dashboard-divider"></div>
      
      <!-- Section 8: Technical Details -->
      <div class="dashboard-section section-8 bg-light-gray back-section">
        <div class="section-content">
          <details class="technical-details">
            <summary class="text-small technical-summary">Technical Details</summary>
            <div class="technical-content">
              <div class="text-small">
                <strong>Timestamp:</strong> <span id="error-timestamp"></span><br>
                <strong>User Agent:</strong> <span id="user-agent"></span><br>
                <strong>URL:</strong> <span id="current-url"></span><br>
                {{#if stack}}
                <strong>Stack Trace:</strong>
                <pre class="stack-trace">{{stack}}</pre>
                {{/if}}
              </div>
            </div>
          </details>
        </div>
      </div>
      
      <!-- Status Indicator (Hidden - for JS compatibility) -->
      <div 
        id="indicator"
        class="status-indicator not-synced" 
        role="img" 
        aria-label="Error status indicator"
        style="display: none;"
      ></div>
    </main>
  </div>
  
  <script src="/public/scripts/utils.js"></script>
  <script src="/public/scripts/enhancements.js"></script>
  <script>
    // Populate technical details
    Utils.ready(() => {
      const timestampEl = document.getElementById('error-timestamp');
      const userAgentEl = document.getElementById('user-agent');
      const currentUrlEl = document.getElementById('current-url');
      
      if (timestampEl) timestampEl.textContent = new Date().toISOString();
      if (userAgentEl) userAgentEl.textContent = navigator.userAgent;
      if (currentUrlEl) currentUrlEl.textContent = window.location.href;
    });
  </script>
</body>
</html>