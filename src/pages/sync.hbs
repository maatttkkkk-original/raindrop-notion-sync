<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>{{#if (eq mode 'all')}}Full Sync{{else}}Incremental Sync{{/if}} - Raindrop Notion</title>
  
  <!-- Stylesheets -->
  <link rel="stylesheet" href="/public/styles/design-system.css">
  <link rel="stylesheet" href="/public/styles/components.css">
  <link rel="stylesheet" href="/public/styles/sync.css">
</head>
<body>
  <div class="container">
    <!-- Header -->
    <header class="header">
      <a href="/?password={{password}}" class="back-link">‚Üê Back to Dashboard</a>
      <h1 class="page-title">
        {{#if (eq mode 'all')}}
          Full Sync
        {{else}}
          Incremental Sync
        {{/if}}
      </h1>
      <p class="page-subtitle">
        {{#if (eq mode 'all')}}
          Complete reconciliation of all bookmarks
        {{else}}
          Sync recent bookmarks only
        {{/if}}
      </p>
    </header>

    <!-- Sync Interface -->
    <main class="sync-main">
      <!-- Sync Card -->
      <div class="sync-card">
        <div class="sync-header">
          <div class="sync-icon">
            {{#if (eq mode 'all')}}
              üîÑ
            {{else}}
              ‚ö°
            {{/if}}
          </div>
          <div class="sync-info">
            <h2 class="sync-title">
              {{#if (eq mode 'all')}}
                Full Synchronization
              {{else}}
                Incremental Sync
              {{/if}}
            </h2>
            <p class="sync-description">
              {{#if (eq mode 'all')}}
                Performs complete analysis using Smart Diff technology. Only processes items that need changes for maximum efficiency.
              {{else}}
                Syncs only recent bookmarks added to Raindrop.io.
              {{/if}}
            </p>
          </div>
        </div>

        <!-- Action Button -->
        <div class="sync-controls">
          <button id="startBtn" class="btn btn-primary btn-large">
            {{#if (eq mode 'all')}}
              Start Full Sync
            {{else}}
              Start Incremental Sync
            {{/if}}
          </button>
        </div>

        <!-- Progress Indicator -->
        <div class="progress-container" style="display: none;">
          <div class="progress-bar">
            <div class="progress-fill"></div>
          </div>
          <div class="progress-text">Starting sync...</div>
        </div>
      </div>

      <!-- Status Display -->
      <div class="status-container">
        <div id="status" class="status-display"></div>
      </div>

      <!-- Results Display -->
      <div id="result" class="result-container" style="display: none;">
        <!-- Results will be populated by JavaScript -->
      </div>
    </main>

    <!-- Feature Info -->
    <aside class="feature-info">
      <div class="feature-card">
        <h3>‚ú® Smart Diff Technology</h3>
        <p>Our advanced algorithm analyzes all data once and processes only the differences, achieving 95%+ efficiency improvements.</p>
        
        <div class="feature-stats">
          <div class="stat">
            <span class="stat-number">2</span>
            <span class="stat-label">API Calls</span>
          </div>
          <div class="stat">
            <span class="stat-number">~97%</span>
            <span class="stat-label">Efficiency</span>
          </div>
          <div class="stat">
            <span class="stat-number">1-2min</span>
            <span class="stat-label">Completion</span>
          </div>
        </div>
      </div>

      {{#if (eq mode 'all')}}
      <div class="feature-card">
        <h3>üîç Full Reconciliation</h3>
        <p>Compares all bookmarks in both systems and identifies:</p>
        <ul>
          <li>New items to add</li>
          <li>Existing items to update</li>
          <li>Orphaned items to remove</li>
        </ul>
      </div>
      {{else}}
      <div class="feature-card">
        <h3>‚ö° Quick Updates</h3>
        <p>Focuses on recent activity for fast synchronization:</p>
        <ul>
          <li>Last 30 days of bookmarks</li>
          <li>Modified items only</li>
          <li>Minimal processing time</li>
        </ul>
      </div>
      {{/if}}
    </aside>
  </div>

  <!-- Scripts -->
  <script src="/public/scripts/utils.js"></script>
  <script src="/public/scripts/prevention.js"></script>
  <script src="/public/scripts/sync.js"></script>

  <!-- Initialize with mode -->
  <script>
    // Pass mode to sync manager
    if (window.syncManager) {
      const urlParams = new URLSearchParams(window.location.search);
      window.syncManager.mode = urlParams.get('mode') || 'all';
    }
  </script>
</body>
</html>