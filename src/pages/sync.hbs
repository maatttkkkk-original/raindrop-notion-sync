<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>{{#if (eq mode "reset")}}Reset & Full Sync{{else if (eq mode "incremental")}}Incremental Sync{{else}}Smart Sync{{/if}} - Raindrop Notion</title>
  
  <link rel="stylesheet" href="/public/styles/design-system.css">
  <link rel="stylesheet" href="/public/styles/components.css">
  <link rel="stylesheet" href="/public/styles/dashboard.css">
</head>
<body>
  <div class="container">
    <main class="sync-page" id="main-content" role="main">
      <header class="sync-header">
        <a href="/?password={{password}}" class="back-button">‚Üê Back to Dashboard</a>
        
        <h1 class="text-huge sync-title">
          {{#if (eq mode "reset")}}
            Reset & Full Sync
          {{else if (eq mode "incremental")}}
            Incremental Sync
          {{else}}
            Smart Sync
          {{/if}}
        </h1>
        
        <p class="text-medium sync-description">
          {{#if (eq mode "reset")}}
            Delete all Notion pages and recreate from Raindrop
          {{else if (eq mode "incremental")}}
            Sync only recent bookmarks ({{daysBack}} days)
          {{else}}
            Smart analysis - only sync what needs to change
          {{/if}}
        </p>
      </header>

      <section class="sync-interface">
        <div class="sync-controls">
          <button id="syncBtn" class="action-button primary sync-button" type="button">
            {{#if (eq mode "reset")}}
              Start Reset & Full Sync
            {{else if (eq mode "incremental")}}
              Start Incremental Sync
            {{else}}
              Start Smart Sync
            {{/if}}
          </button>
        </div>

        <div class="sync-progress" id="progress-section">
          <div class="progress-bar">
            <div class="progress-fill" id="progress-fill"></div>
          </div>
          <div class="progress-text" id="progress-text">Preparing sync...</div>
        </div>

        <div class="sync-status">
          <div 
            id="status" 
            class="status-display" 
            role="log" 
            aria-live="polite" 
            aria-label="Sync progress updates"
          ></div>
        </div>

        <div class="sync-stats" id="sync-stats">
          <div class="stat-group">
            <div class="stat-item">
              <span class="stat-number" id="added-count">0</span>
              <span class="stat-label">Added</span>
            </div>
            <div class="stat-item">
              <span class="stat-number" id="updated-count">0</span>
              <span class="stat-label">Updated</span>
            </div>
            <div class="stat-item">
              <span class="stat-number" id="deleted-count">0</span>
              <span class="stat-label">Deleted</span>
            </div>
            <div class="stat-item">
              <span class="stat-number" id="skipped-count">0</span>
              <span class="stat-label">Skipped</span>
            </div>
          </div>
          
          {{#unless (eq mode "reset")}}
          <div class="efficiency-display">
            <div class="efficiency-stat">
              <span class="efficiency-number" id="efficiency-percentage">--</span>
              <span class="efficiency-label">Efficiency</span>
            </div>
            <div class="efficiency-status" id="efficiency-status">
              Analyzing...
            </div>
          </div>
          {{/unless}}
        </div>
      </section>

      <aside class="sync-info">
        {{#if (eq mode "reset")}}
        <div class="info-card warning">
          <h3>‚ö†Ô∏è Reset Mode</h3>
          <p>This will delete all existing Notion pages and recreate them from Raindrop. This operation cannot be undone.</p>
          <ul>
            <li>All Notion pages will be deleted</li>
            <li>All bookmarks will be recreated</li>
            <li>Custom Notion data will be lost</li>
          </ul>
        </div>
        {{else if (eq mode "incremental")}}
        <div class="info-card">
          <h3>‚ö° Incremental Sync</h3>
          <p>Fast synchronization focusing on recent activity:</p>
          <ul>
            <li>Last {{daysBack}} days of bookmarks</li>
            <li>Modified items only</li>
            <li>Minimal processing time</li>
            <li>Preserves existing data</li>
          </ul>
        </div>
        {{else}}
        <div class="info-card">
          <h3>üß† Smart Sync Technology</h3>
          <p>Advanced algorithm that analyzes all data and processes only necessary changes:</p>
          <ul>
            <li>Intelligent difference detection</li>
            <li>95%+ efficiency improvement</li>
            <li>Preserves unchanged data</li>
            <li>Minimal API usage</li>
          </ul>
        </div>
        {{/unless}}
        
        <div class="info-card">
          <h3>üìä Live Updates</h3>
          <p>Real-time progress tracking with detailed insights:</p>
          <ul>
            <li>Live progress streaming</li>
            <li>Operation counts</li>
            <li>Efficiency metrics</li>
            <li>Error reporting</li>
          </ul>
        </div>
      </aside>
    </main>
  </div>

  <script src="/public/scripts/utils.js"></script>
  <script src="/public/scripts/sync.js"></script>
  <script src="/public/scripts/enhancements.js"></script>
</body>
</html>